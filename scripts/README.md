# HealthAI 2025 ä¸´åºŠåŒ»å­¦æ•°æ®å¤„ç†ç«èµ›æ–¹æ¡ˆ

## ğŸ† æ¯”èµ›èƒŒæ™¯

æœ¬é¡¹ç›®æ˜¯ **[HealthAI 2025 å¥åº·æ™ºèƒ½æŒ‘æˆ˜èµ›ä¸­çš„HealthAI 2025 ä¸´åºŠåŒ»å­¦æ•°æ®å¤„ç†ç«èµ›](https://competition.pkucxpl.com/)** çš„å‚èµ›æ–¹æ¡ˆã€‚

### æ¯”èµ›ä»‹ç»

éšç€ç§‘æŠ€çš„å¿«é€Ÿè¿›æ­¥å’Œæ•°å­—ç»æµçš„è“¬å‹ƒå‘å±•ï¼Œæˆ‘å›½åŒ»ç–—å¥åº·äº§ä¸šæ­£é¢ä¸´ç€å‰æ‰€æœªæœ‰çš„æœºé‡ä¸æŒ‘æˆ˜ã€‚ä»¥äººå·¥æ™ºèƒ½ä¸ºä»£è¡¨çš„æ–°ä¸€ä»£ä¿¡æ¯æŠ€æœ¯æ­£åœ¨å¸®åŠ©ä¸´åºŠè¯Šç–—ã€è¯ç‰©ç ”å‘ç­‰åŠ é€Ÿè¿›æ­¥ï¼Œå±•ç°å‡ºå·¨å¤§çš„å‘å±•æ½œåŠ›å’Œåº”ç”¨å‰æ™¯ã€‚

æœ¬æ¬¡æ¯”èµ›ç”±æ”¯ä»˜å®æºæ‰‹ç»„å§”ä¼šæä¾›æ•°æ®é›†ï¼Œæ¶µç›–åŒ»ç–—é¢†åŸŸä¹¦ç±ã€è®ºæ–‡ã€ç½‘é¡µã€è™šæ‹Ÿæ‚£è€…ç—…å†ã€ä¸´åºŠæŠ¥å‘Šç­‰å¤šç§ç±»å‹æ•°æ®ã€‚

### æ¯”èµ›è§„åˆ™ä¸é™åˆ¶

- **æŒ‡å®šæ¨¡å‹**ï¼šå¿…é¡»ä½¿ç”¨ `Qwen2.5-7B-Instruct` ä½œä¸ºæœ€ç»ˆæäº¤æ¨¡å‹
- **å…è®¸æ“ä½œ**ï¼šé¢„è®­ç»ƒã€SFTï¼ˆç›‘ç£å¾®è°ƒï¼‰ã€Prompt Learningç­‰
- **APIé™åˆ¶**ï¼šç¦æ­¢ä½¿ç”¨ä»»ä½•æ”¶è´¹APIè¿›è¡Œæ•°æ®è’¸é¦
- **å¼€æºAPI**ï¼šå¯ä»¥ä½¿ç”¨å¼€æºæ¨¡å‹APIï¼ˆå¦‚DeepSeekã€Qwen-72Bç­‰ï¼‰

### æŠ€æœ¯æ–¹æ¡ˆæ¦‚è¿°

æœ¬å‚èµ›æ–¹æ¡ˆé‡‡ç”¨ **ä¸¤é˜¶æ®µæŠ€æœ¯è·¯çº¿**ï¼š

**é˜¶æ®µä¸€ï¼šSFTå¾®è°ƒ**
1. ä½¿ç”¨Qwen2.5-72B-Instruct APIå¯¹è®­ç»ƒæ•°æ®é›†(`camp_data_step_1_without_answer.jsonl`)ç”Ÿæˆç­”æ¡ˆ
2. ç”¨ç”Ÿæˆçš„é—®ç­”æ•°æ®å¾®è°ƒQwen2.5-7B-Instructæ¨¡å‹
3. ä½¿ç”¨å¾®è°ƒåçš„æ¨¡å‹å¯¹æµ‹è¯•æ•°æ®é›†(`camp_data_step_2_without_answer.jsonl`)ç”Ÿæˆç­”æ¡ˆ

**é˜¶æ®µäºŒï¼šçŸ¥è¯†è’¸é¦ï¼ˆå¯é€‰ä¼˜åŒ–ï¼‰**
1. é‡æ–°ä½¿ç”¨Qwen2.5-72B-Instruct APIç”Ÿæˆæ›´é«˜è´¨é‡çš„soft labelç­”æ¡ˆ
2. åŸºäºæ–°çš„è’¸é¦æ•°æ®è¿›ä¸€æ­¥ä¼˜åŒ–æ¨¡å‹æ€§èƒ½
3. æ³¨ï¼šç”±äºä½¿ç”¨APIå½¢å¼çš„teacheræ¨¡å‹ï¼Œè¿™æ˜¯ä¸€ç§"ä¼ªè’¸é¦"æ–¹æ³•

## ğŸ—ï¸ é¡¹ç›®ç»“æ„

```
scripts/
â”œâ”€â”€ core/                           # æ ¸å¿ƒåŸºç¡€æ¨¡å—
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ config_manager.py           # é…ç½®ç®¡ç†
â”‚   â”œâ”€â”€ model_loader.py             # æ¨¡å‹åŠ è½½å™¨
â”‚   â””â”€â”€ error_handler.py            # é”™è¯¯å¤„ç†
â”œâ”€â”€ sft/                            # æ¨¡å‹å¾®è°ƒæ¨¡å—
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ finetune.py                 # ç»Ÿä¸€å¾®è°ƒå…¥å£
â”‚   â”œâ”€â”€ generate_diagnosis.py       # è¯Šæ–­ç”Ÿæˆ
â”‚   â””â”€â”€ inference.py                # æ¨ç†åŠŸèƒ½
â”œâ”€â”€ distillation/                   # çŸ¥è¯†è’¸é¦æ¨¡å—  
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ distillation_engine.py      # ç»Ÿä¸€è’¸é¦å¼•æ“
â”‚   â””â”€â”€ api_distillation.py         # APIè’¸é¦æ–¹æ¡ˆ
â”œâ”€â”€ utils/                          # å·¥å…·æ¨¡å—
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ data_utils.py               # æ•°æ®å¤„ç†å·¥å…·
â”‚   â””â”€â”€ model_utils.py              # æ¨¡å‹å·¥å…·
â”œâ”€â”€ configs/                        # é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ sft_config.json             # SFTé…ç½®
â”‚   â”œâ”€â”€ distillation_config.json    # è’¸é¦é…ç½®
â”‚   â””â”€â”€ ds_config.json              # DeepSpeedé…ç½®
â””â”€â”€ README.md                       # é¡¹ç›®æ–‡æ¡£
```

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### ç¯å¢ƒå‡†å¤‡

```bash
pip install -r requirements.txt
```

### é˜¶æ®µä¸€ï¼šSFTå¾®è°ƒæµç¨‹

#### 1. APIç”Ÿæˆè®­ç»ƒæ•°æ®

ä½¿ç”¨Qwen2.5-72B-Instruct APIä¸ºè®­ç»ƒæ•°æ®ç”Ÿæˆç­”æ¡ˆï¼š

```bash
python scripts/distillation/api_distillation.py \
    --api_key YOUR_QWEN_API_KEY \
    --input_file data/camp_data_step_1_without_answer.jsonl \
    --output_file data/sft_training_data.json \
    --teacher_model qwen2.5-72b-instruct \
    --max_samples 1000
```

#### 2. æ¨¡å‹å¾®è°ƒ

åŸºäºç”Ÿæˆçš„é—®ç­”æ•°æ®å¾®è°ƒQwen2.5-7B-Instructï¼š

```bash
python scripts/sft/finetune.py \
    --data_path data/sft_training_data.json \
    --model_name Qwen/Qwen2.5-7B-Instruct \
    --output_dir models/sft_model \
    --num_epochs 3 \
    --batch_size 4
```

#### 3. æµ‹è¯•æ•°æ®æ¨ç†

ä½¿ç”¨å¾®è°ƒåçš„æ¨¡å‹å¯¹æµ‹è¯•æ•°æ®ç”Ÿæˆç­”æ¡ˆï¼š

```bash
python scripts/sft/inference.py \
    --model_path models/sft_model \
    --input_file data/camp_data_step_2_without_answer.jsonl \
    --output_file results/test_results.json
```

### é˜¶æ®µäºŒï¼šçŸ¥è¯†è’¸é¦ä¼˜åŒ–ï¼ˆå¯é€‰ï¼‰

#### 1. ç”Ÿæˆè’¸é¦æ•°æ®

é‡æ–°ä½¿ç”¨APIç”Ÿæˆæ›´é«˜è´¨é‡çš„soft labelæ•°æ®ï¼š

```bash
python scripts/distillation/api_distillation.py \
    --api_key YOUR_QWEN_API_KEY \
    --input_file data/camp_data_step_1_without_answer.jsonl \
    --output_file data/distillation_training_data.json \
    --teacher_model qwen2.5-72b-instruct \
    --temperature 0.7 \
    --max_tokens 800
```

#### 2. è’¸é¦è®­ç»ƒ

åŸºäºè’¸é¦æ•°æ®è¿›ä¸€æ­¥ä¼˜åŒ–æ¨¡å‹ï¼š

```bash
python scripts/distillation/distillation_engine.py \
    --data_path data/distillation_training_data.json \
    --distillation_type api \
    --api_key YOUR_QWEN_API_KEY \
    --student_model Qwen/Qwen2.5-7B-Instruct \
    --output_dir models/distilled_model
```

## ğŸ“Š æ ¸å¿ƒåŠŸèƒ½æ¨¡å—

### ğŸ”§ SFTå¾®è°ƒæ¨¡å—
- **LoRAå¾®è°ƒ**ï¼šé«˜æ•ˆå‚æ•°æ›´æ–°ï¼Œå‡å°‘å†…å­˜å ç”¨
- **4bité‡åŒ–**ï¼šæ”¯æŒæœ‰é™ç¡¬ä»¶èµ„æºä¸‹çš„æ¨¡å‹è®­ç»ƒ
- **æ¢¯åº¦ç´¯ç§¯**ï¼šä¼˜åŒ–å°æ‰¹æ¬¡è®­ç»ƒæ•ˆæœ
- **å¤šæ ¼å¼æ”¯æŒ**ï¼šæ”¯æŒJSONå’ŒJSONLæ ¼å¼æ•°æ®

### ğŸ§  çŸ¥è¯†è’¸é¦æ¨¡å—
- **APIè’¸é¦**ï¼šé€šè¿‡APIè°ƒç”¨å¤§æ¨¡å‹è¿›è¡Œ"ä¼ªè’¸é¦"
- **æƒé‡ä¼˜åŒ–**ï¼šé’ˆå¯¹åŒ»ç–—æ¨ç†çš„tokenæƒé‡è°ƒæ•´
- **æ¸©åº¦æ§åˆ¶**ï¼šè°ƒèŠ‚soft labelçš„è½¯åŒ–ç¨‹åº¦
- **è´¨é‡æ§åˆ¶**ï¼šAPIè°ƒç”¨å¤±è´¥å¤„ç†å’Œæ•°æ®éªŒè¯

### ğŸ› ï¸ å·¥å…·æ”¯æŒ
- **æ•°æ®å¤„ç†**ï¼šåŒ»ç–—æ•°æ®é¢„å¤„ç†å’Œæ ¼å¼è½¬æ¢
- **æ¨¡å‹å·¥å…·**ï¼šæ¨¡å‹åŠ è½½ã€ä¿¡æ¯è·å–ã€å†…å­˜ä¼°ç®—
- **é”™è¯¯å¤„ç†**ï¼šå®Œå–„çš„å¼‚å¸¸å¤„ç†æœºåˆ¶
- **é…ç½®ç®¡ç†**ï¼šç»Ÿä¸€çš„é…ç½®ç®¡ç†ç³»ç»Ÿ

## ğŸš¨ æ³¨æ„äº‹é¡¹

1. **APIå¯†é’¥å®‰å…¨**ï¼šè¯·å¦¥å–„ä¿ç®¡APIå¯†é’¥ï¼Œä¸è¦æäº¤åˆ°ä»£ç ä»“åº“
2. **å†…å­˜ç®¡ç†**ï¼šå¤§æ¨¡å‹è®­ç»ƒéœ€è¦è¶³å¤Ÿçš„GPUå†…å­˜ï¼Œå»ºè®®ä½¿ç”¨é‡åŒ–
3. **æ•°æ®è´¨é‡**ï¼šç¡®ä¿è®­ç»ƒæ•°æ®çš„è´¨é‡å’Œæ ¼å¼æ­£ç¡®æ€§
4. **ä¸¤é˜¶æ®µç‹¬ç«‹**ï¼šSFTå’Œè’¸é¦å¯ä»¥ç‹¬ç«‹è¿›è¡Œï¼Œè’¸é¦æ˜¯å¯é€‰çš„ä¼˜åŒ–æ­¥éª¤

---

**HealthAI 2025 å‚èµ›æ–¹æ¡ˆ** - ä¸¤é˜¶æ®µåŒ»ç–—AIæ¨¡å‹ä¼˜åŒ–æŠ€æœ¯è·¯çº¿ ğŸ†ğŸ¥ 